<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Documentation</title>

    <link type="text/css" rel="stylesheet" href="assets/css/reset.css">
    <link type="text/css" rel="stylesheet" href="http://yandex.st/highlightjs/7.3/styles/github.min.css">
    <link type="text/css" rel="stylesheet" href="assets/css/docs.css">
    <link type="text/css" rel="stylesheet" href="assets/css/print.css" media="print">
    

    <script type="text/javascript" src="assets/js/jquery-1.10.1.min.js"></script>
    <script type="text/javascript" src="http://yandex.st/highlightjs/6.1/highlight.min.js"></script>
    <script type="text/javascript" src="assets/js/lunr.min.js"></script>

    

    <script type="text/javascript">var BASE_URL = "";</script>
    <script type="text/javascript" src="assets/js/viewer.js"></script>

    
</head>
<body>
    <div id="page">
        <a name="top" />
        <header id="header">
			<div style="overflow:hidden">
				<div style="float:left">
					<img src="assets/img/logo.png"/>
					
				</div>	
				<div style="float:left;padding-top: 15px;padding-left: 30px;">
		            <h1><a href="">Documentation</a></h1>

				</div>
			</div>
        </header>
        

<div id="sidebar">
    <form action="search.html"><input id="search" type="text" placeholder="Search" name="q" /></form>
    <nav id="toc">
        
    <ol>
    
        <li>
            <a href="01-0-introduction.html">Introduction</a>
            
                
    <ol>
    
        <li>
            <a href="01-1-whats-new-3.html">What's new in 3.0?</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="01-2-migrationto3.html">Upgrading from 2.x versions</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="01-3-gettingstarted.html">Getting Started (Tutorial)</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="02-0-distributed-data-structures.html">Distributed Data Structures</a>
            
                
    <ol>
    
        <li>
            <a href="02-1-0-map.html">Distributed Map</a>
            
                
    <ol>
    
        <li>
            <a href="02-1-10-mapentry.html">Entry Statistics</a>
            
        </li>
    
        <li>
            <a href="02-1-11-mapinmemoryformat.html">In Memory Format</a>
            
        </li>
    
        <li>
            <a href="02-1-1-mapbackup.html">Backups</a>
            
        </li>
    
        <li>
            <a href="02-1-2-mapeviction.html">Eviction</a>
            
        </li>
    
        <li>
            <a href="02-1-3-mappersistence.html">Persistence</a>
            
        </li>
    
        <li>
            <a href="02-1-4-mapquery.html">Query</a>
            
        </li>
    
        <li>
            <a href="02-1-5-mapindex.html">Indexing</a>
            
        </li>
    
        <li>
            <a href="02-1-6-mapcontinuousquery.html">Continuous Query</a>
            
        </li>
    
        <li>
            <a href="02-1-7-mapentryprocessor.html">Entry Processor</a>
            
        </li>
    
        <li>
            <a href="02-1-8-mapinterceptor.html">Interceptors</a>
            
        </li>
    
        <li>
            <a href="02-1-9-mapnearcache.html">Near Cache</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="02-2-0-queue.html">Distributed Queue</a>
            
                
    <ol>
    
        <li>
            <a href="02-2-0-queue.html">Persistence</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="02-3-0-multimap.html">Distributed MultiMap</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="02-4-0-topic.html">Distributed Topic</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="02-5-0-set.html">Distributed Set</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="02-6-0-list.html">Distributed List</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="02-7-0-lock.html">Distributed Lock</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="02-8-0-events.html">Distributed Events</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="03-0-serialization.html">Serialization</a>
            
                
    <ol>
    
        <li>
            <a href="03-1-dataserializable.html">Data Serializable</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="03-2-portable.html">Portable Serialization</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="03-3-custom.html">Custom Serialization</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="04-0-dataaffinity.html">Data Affinity</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="05-0-jmx.html">Monitoring with JMX</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="06-0-clusterutilities.html">Cluster Utilities</a>
            
                
    <ol>
    
        <li>
            <a href="06-1-clusterinterface.html">Cluster Interface</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="06-2-idgenerator.html">Cluster-wide Id Generator</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="07-0-transactions.html">Transactions</a>
            
                
    <ol>
    
        <li>
            <a href="07-1-transactioninterface.html">Transaction Interface</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="07-2-jeeintegration.html">J2EE Integration</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="08-0-executorservice.html">Distributed Executor Service</a>
            
                
    <ol>
    
        <li>
            <a href="08-1-distributedexecution.html">Distributed Execution</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="08-2-executioncancellation.html">Execution Cancellation</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="08-3-executioncallback.html">Execution Callback</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="09-0-httpsessionclustering.html">Http Session Clustering with HazelcastWM</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="10-0-wanreplication.html">WAN Replication</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="11-0-spi.html">Service Provider Interface</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="12-0-config.html">Configuration</a>
            
                
    <ol>
    
        <li>
            <a href="12-1-configgroup.html">Creating Separate Clusters</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="12-2-0-networkconfig.html">Network Configuration</a>
            
                
    <ol>
    
        <li>
            <a href="12-2-1-configtcpip.html">Configuring TCP/IP Cluster</a>
            
        </li>
    
        <li>
            <a href="12-2-2-configspecifyinterfaces.html">Specifying Network Interfaces</a>
            
        </li>
    
        <li>
            <a href="12-2-3-ec2autodiscovery.html">EC2 Auto Discovery</a>
            
        </li>
    
        <li>
            <a href="12-2-4-networkpartitioning.html">Network Partitioning (Split-Brain Syndrome)</a>
            
        </li>
    
        <li>
            <a href="12-2-5-ssl.html">SSL</a>
            
        </li>
    
        <li>
            <a href="12-2-6-encryption.html">Encryption</a>
            
        </li>
    
        <li>
            <a href="12-2-7-socketinterceptor.html">Socket Interceptor</a>
            
        </li>
    
        <li>
            <a href="12-2-8-ipv6.html">IPv6 Support</a>
            
        </li>
    
        <li>
            <a href="12-2-9-outboundports.html">Restricting Outbound Ports</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="12-3-partitiongroupconfig.html">Partition Group Configuration</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="12-4-listenerconfig.html">Listener Configurations</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="12-5-wildcardconfiguration.html">Wildcard Configuration</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="12-6-configurationproperties.html">Advanced Configuration Properties</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="12-7-logging.html">Logging Configuration</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="12-8-enterpriseconfig.html">Setting License Key &lt;sup&gt;(Enterprise Edition Only)&lt;/sup&gt;</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="13-0-hibernatesecondlevelcache.html">Hibernate Second Level Cache</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="14-0-springintegration.html">Spring Integration</a>
            
                
    <ol>
    
        <li>
            <a href="14-1-springconfig.html">Configuration</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="14-2-springcontext.html">Spring Managed Context</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="14-3-springcache.html">Spring Cache</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="14-4-springhibernate.html">Hibernate 2nd Level Cache Config</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="14-5-springjpa.html">Spring Data - JPA</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="14-6-springmongodb.html">Spring Data - MongoDB</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="15-0-clients.html">Clients</a>
            
                
    <ol>
    
        <li>
            <a href="15-1-nativeclient.html">Native Client</a>
            
                
    <ol>
    
        <li>
            <a href="15-1-nativeclient.html">Java Client</a>
            
        </li>
    
        <li>
            <a href="15-1-nativeclient.html">CSharp Client &lt;sup&gt;(Enterprise Edition Only)&lt;/sup&gt;</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="15-2-memcacheclient.html">Memcache Client</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="15-3-restclient.html">Rest Client</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="16-0-managementcenter.html">Management Center</a>
            
                
    <ol>
    
        <li>
            <a href="16-1-introduction.html">Introduction</a>
            
                
    <ol>
    
        <li>
            <a href="16-1-introduction.html">Installation</a>
            
        </li>
    
        <li>
            <a href="16-1-introduction.html">User Administration</a>
            
        </li>
    
        <li>
            <a href="16-1-introduction.html">Tool Overview</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="16-2-maps.html">Maps</a>
            
                
    <ol>
    
        <li>
            <a href="16-2-maps.html">Monitoring Maps</a>
            
        </li>
    
        <li>
            <a href="16-2-maps.html">Map Browser</a>
            
        </li>
    
        <li>
            <a href="16-2-maps.html">Map Configuration</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="16-3-queues.html">Queues</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="16-4-topics.html">Topics</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="16-5-members.html">Members</a>
            
                
    <ol>
    
        <li>
            <a href="16-5-members.html">Monitoring</a>
            
        </li>
    
        <li>
            <a href="16-5-members.html">Operations</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="16-6-logs.html">System Logs</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="16-7-scripting.html">Scripting</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="16-8-timetravel.html">Time Travel</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="16-9-console.html">Console</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="17-0-misc.html">Miscellaneous</a>
            
                
    <ol>
    
        <li>
            <a href="17-1-commongotchas.html">Common Gotchas</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="17-2-clustertesthowto.html">Testing Cluster</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="17-3-todo.html">Planned Features</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
</ol>

            
        </li>
    
</ol>

    </nav>
    
    <nav id="links">
        <ul>
            
        </ul>
    </nav>
    
</div>

        <div id="content">
            <a name="hibernate-second-level-cache"></a><h1>Hibernate Second Level Cache</h1>
<p>Hazelcast provides distributed second level cache for your Hibernate entities, collections and queries. Hazelcast has two implementations of Hibernate 2nd level cache, one for hibernate-pre-3.3 and one for hibernate-3.3.x versions. In your Hibernate configuration file (ex: hibernate.cfg.xml), add these properties:</p>
<ul>
<li>To enable use of second level cache</li>
</ul>
<pre><code class="lang-xml">&lt;property name=&quot;hibernate.cache.use_second_level_cache&quot;&gt;true&lt;/property&gt;</code></pre>
<ul>
<li>To enable use of query cache</li>
</ul>
<pre><code class="lang-xml">&lt;property name=&quot;hibernate.cache.use_query_cache&quot;&gt;true&lt;/property&gt;</code></pre>
<ul>
<li>And to force minimal puts into cache</li>
</ul>
<pre><code class="lang-xml">&lt;property name=&quot;hibernate.cache.use_minimal_puts&quot;&gt;true&lt;/property&gt;</code></pre>
<ul>
<li><p>To configure Hazelcast for Hibernate, it is enough to put configuration file named <code>hazelcast.xml</code> into root of your classpath. If Hazelcast can not find <code>hazelcast.xml</code> then it will use default configuration from hazelcast.jar.</p>
</li>
<li><p>You can define custom named Hazelcast configuration xml file with one of these Hibernate configuration properties.</p>
</li>
</ul>
<pre><code class="lang-xml">&lt;property name=&quot;hibernate.cache.provider_configuration_file_resource_path&quot;&gt;
     hazelcast-custom-config.xml
&lt;/property&gt;</code></pre>
<p>or</p>
<pre><code class="lang-xml">&lt;property name=&quot;hibernate.cache.hazelcast.configuration_file_path&quot;&gt;
     hazelcast-custom-config.xml
&lt;/property&gt;</code></pre>
<ul>
<li>You can set up Hazelcast to connect cluster as LiteMember. LiteMember is a member of the cluster, it has socket connection to every member in the cluster and it knows where the data, but does not contain any data.</li>
</ul>
<pre><code class="lang-xml">&lt;property name=&quot;hibernate.cache.hazelcast.use_lite_member&quot;&gt;true&lt;/property&gt;</code></pre>
<ul>
<li>You can set up Hazelcast to connect cluster as Native Client. Native client is not member and it connects to one of the cluster members and delegates all cluster wide operations to it. When the relied cluster member dies, client will transparently switch to another live member. <em>(Native Client property takes precedence over LiteMember property.)</em></li>
</ul>
<pre><code class="lang-xml">&lt;property name=&quot;hibernate.cache.hazelcast.use_native_client&quot;&gt;true&lt;/property&gt;</code></pre>
<pre><code>To setup Native Client properly, you should add Hazelcast **group-name**, **group-password** and **cluster member address** properties. Native Client will connect to defined member and will get addresses of all members in the cluster. If the connected member will die or leave the cluster, client will automatically switch to another member in the cluster.</code></pre>
<pre><code class="lang-xml">&lt;property name=&quot;hibernate.cache.hazelcast.native_client_address&quot;&gt;10.34.22.15&lt;/property&gt;
&lt;property name=&quot;hibernate.cache.hazelcast.native_client_group&quot;&gt;dev&lt;/property&gt;
&lt;property name=&quot;hibernate.cache.hazelcast.native_client_password&quot;&gt;dev-pass&lt;/property&gt;</code></pre>
<p><em>To use Native Client you should add <code>hazelcast-client-&lt;version&gt;.jar</code> into your classpath.</em></p>
<p><a href="#native-client">Read more about NativeClient &amp; LiteMember</a></p>
<ul>
<li>To define Hibernate RegionFacyory, add following property.</li>
</ul>
<pre><code class="lang-xml">&lt;property name=&quot;hibernate.cache.region.factory_class&quot;&gt;
     com.hazelcast.hibernate.HazelcastCacheRegionFactory
&lt;/property&gt;</code></pre>
<pre><code>Or as an alternative you can use `HazelcastLocalCacheRegionFactory` which stores data in local node and sends invalidation messages when an entry is updated on local.</code></pre>
<pre><code class="lang-xml">&lt;property name=&quot;hibernate.cache.region.factory_class&quot;&gt;
     com.hazelcast.hibernate.HazelcastLocalCacheRegionFactory
&lt;/property&gt;</code></pre>
<p>Hazelcast creates a separate distributed map for each Hibernate cache region. So these regions can be configured easily via Hazelcast map configuration. You can define <strong>backup</strong>, <strong>eviction</strong>, <strong>TTL</strong> and <strong>Near Cache</strong> properties.</p>
<ul>
<li><p><a href="#backups">Backup Configuration</a></p>
</li>
<li><p><a href="#eviction">Eviction And TTL Configuration</a></p>
</li>
<li><p><a href="#near-cache">Near Cache Configuration</a></p>
</li>
</ul>
<p>Hibernate has four cache concurrency strategies: <em>read-only</em>, <em>read-write</em>, <em>nonstrict-read-write</em> and <em>transactional</em>. But Hibernate does not forces cache providers to support all strategies. And Hazelcast supports first three (<strong>read-only</strong>, <strong>read-write</strong>, <strong>nonstrict-read-write</strong>) of these four strategies. Hazelcast has no support for <em>transactional</em> strategy yet.</p>
<ul>
<li>If you are using xml based class configurations, you should add a <em>cache</em> element into your configuration with <em>usage</em> attribute with one of <em>read-only</em>, <em>read-write</em>, <em>nonstrict-read-write</em>.</li>
</ul>
<pre><code class="lang-xml">&lt;class name=&quot;eg.Immutable&quot; mutable=&quot;false&quot;&gt;
    &lt;cache usage=&quot;read-only&quot;/&gt;
    .... 
&lt;/class&gt;

&lt;class name=&quot;eg.Cat&quot; .... &gt;
    &lt;cache usage=&quot;read-write&quot;/&gt;
    ....
    &lt;set name=&quot;kittens&quot; ... &gt;
        &lt;cache usage=&quot;read-write&quot;/&gt;
        ....
    &lt;/set&gt;
&lt;/class&gt;</code></pre>
<ul>
<li>If you are using Hibernate-Annotations then you can add <em>class-cache</em> or <em>collection-cache</em> element into your Hibernate configuration file with <em>usage</em> attribute with one of <em>read only</em>, <em>read/write</em>, <em>nonstrict read/write</em>.</li>
</ul>
<pre><code class="lang-xml">&lt;class-cache usage=&quot;read-only&quot; class=&quot;eg.Immutable&quot;/&gt;
&lt;class-cache usage=&quot;read-write&quot; class=&quot;eg.Cat&quot;/&gt;
&lt;collection-cache collection=&quot;eg.Cat.kittens&quot; usage=&quot;read-write&quot;/&gt;</code></pre>
<p>OR</p>
<ul>
<li>Alternatively, you can put Hibernate Annotation&#39;s <em>@Cache</em> annotation on your entities and collections.</li>
</ul>
<pre><code class="lang-java">Cache(usage = CacheConcurrencyStrategy.READ_WRITE)
public class Cat implements Serializable {
     ...
}</code></pre>
<p>The last thing you should be aware of is to drop hazelcast-hibernate-\<version\>.jar into your classpath.</p>
<ul>
<li><p><strong>Accessing underlying <code>HazelcastInstance</code></strong></p>
<p>Using <code>com.hazelcast.hibernate.instance.HazelcastAccessor</code> you can access the underlying <code>HazelcastInstance</code> used by Hibernate SessionFactory.</p>
</li>
</ul>
<pre><code class="lang-java">SessionFactory sessionFactory = ...;
HazelcastInstance hazelcastInstance = HazelcastAccessor.getHazelcastInstance(sessionFactory);</code></pre>
<ul>
<li><p><strong>Changing/setting lock timeout value of <em>read-write</em> strategy</strong></p>
<p>Lock timeout value can be set using <code>hibernate.cache.hazelcast.lock_timeout_in_seconds</code> Hibernate property. Value should be in seconds and default value is 300 seconds.</p>
</li>
<li><p><strong>Using named <code>HazelcastInstance</code></strong></p>
<p>Instead of creating a new <code>HazelcastInstance</code> for each <code>SessionFactory</code>, an existing instance can be used by setting <code>hibernate.cache.hazelcast.instance_name</code> Hibernate property to <code>HazelcastInstance</code>&#39;s name. For more information see <a href="#named-hazelcastinstance">Named HazelcastInstance</a>.</p>
</li>
<li><p><strong>Disabling shutdown during SessionFactory.close()</strong></p>
<p>Shutting down <code>HazelcastInstance</code> can be disabled during <code>SessionFactory.close()</code> by setting <code>hibernate.cache.hazelcast.shutdown_on_session_factory_close</code> Hibernate property to false. <em>(In this case Hazelcast property <code>hazelcast.shutdownhook.enabled</code> should not be set to false.)</em> Default value is <code>true</code>.</p>
</li>
</ul>




        </div>
        <footer id="footer">
            Powered by <a href="http://github.com/maximebf/beautiful-docs">beautiful-docs</a> -
            <a href="#top">Back to top</a>
            - <a href="?print=1">Print current page</a> - <a href="all.html?print=1">Print all pages</a>
        </footer>
    </div>
</body>
</html>
